# Spring Cloud Config

![spring cloud config](../../images/spring-cloud-ms/spring-cloud-config.png)

在分布式微服务系统中，几乎所有服务的运行都离不开配置文件的支持，这些配置文件通常由各个服务自行管理，以`properties`或`yml`格式保存在各个微服务的类路径下，例如`application.properties`或`application.yml`等。

这种将配置文件散落在各个服务中的管理方式，存在以下问题：
* 管理难度大：配置文件散落在各个微服务中，难以管理。
* 安全性低：配置跟随源代码保存在代码库中，容易造成配置泄漏。
* 时效性差：微服务中的配置修改后，必须重启服务，否则无法生效。
* 局限性明显：无法支持动态调整，例如日志开关、功能开关。

为了解决这些问题，通常我们都会使用配置中心对配置进行统一管理。那么Spring Cloud Config应用而生！

## 简介

Spring Cloud Config 是由 Spring Cloud 团队开发的项目，它可以为微服务架构中各个微服务提供集中化的外部配置支持。

简单点说就是，Spring Cloud Config 可以将各个微服务的配置文件集中存储在一个外部的存储仓库或系统（例如 Git 、SVN 等）中，对配置的统一管理，以支持各个微服务的运行

Spring Cloud Config 包含以下两个部分：
* Config Server：也被称为分布式配置中心，它是一个独立运行的微服务应用，用来连接配置仓库并为客户端提供获取配置信息、加密信息和解密信息的访问接口。
* Config Client：指的是微服务架构中的各个微服务，它们通过 Config Server 对配置进行管理，并从 Config Sever 中获取和加载配置信息。

Spring Cloud Config 默认使用 Git 存储配置信息，因此使用 Spirng Cloud Config 构建的配置服务器天然就支持对微服务配置的版本管理。我们可以使用 Git 客户端工具方便地对配置内容进行管理和访问。除了 Git 外，Spring Cloud Config 还提供了对其他存储方式的支持，例如 SVN、本地化文件系统等。

### 工作原理
![config-principle](../../images/spring-cloud-ms/config-principle.jpg)

Spring Cloud Config 工作流程如下：
* 开发或运维人员提交配置文件到远程的 Git 仓库。
* Config Server 负责连接配置仓库Git, 然后在本地存储一份配置的副本，并对 Config 客户端暴露获取配置的接口。
* Config Client 通过Config服务端暴露出来的接口，拉取配置仓库中的配置。
* Config Client 获取到配置信息，以支持服务的运行。
* 管理员可以通过刷新接口，动态的获取配置或者将配置推送给客户端。

### 优势

从Spring Cloud Config的原理我们可以看出，它解决了微服务配置的中心化，版本控制，平台独立，语言独立等问题，其特性如下：

* 提供了客户端和服务端的支持。
* 集中式管理分布式环境下的应用部署。
* 支持基于属性值的对称和非对称加密，提供了安全保障。
* 基于Spring环境，与Spring无缝集成。
* 可以用于任何语言开发的程序。
* 默认实现可以基于Git，可以对配置进行版本管理。

## 基本使用

## 自动刷新

## 加密与解密