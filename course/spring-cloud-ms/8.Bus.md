# Spring Cloud Bus

![bus](../../images/spring-cloud-ms/bus.jpeg)

微服务一般都采用集群方式部署，而且在高并发下经常需要对服务进行扩容，萎缩，上线，下线等操作，比如我们需要更新配置，又或者需要同时失效所有服务上面的某个缓存，此时就需要向所有相关的服务器发送命令，这就需要使用消息总线啦！

## 什么是消息总线？

使用消息代理中间件构建一个共用的消息主题让所有微服务实例订阅，当该消息主题产生消息时会被所有微服务实例监听并消费。

消息代理是一个消息验证，传输，路由的架构模式，主要用来实线接受和分发消息，并根据设定好的消息处理流来转发给正确的应用。它在微服务之间起到通信调度作用，减少了服务之间的依赖。

## Spring Cloud Bus

Spring Cloud Bus是Spring Cloud体系内的消息总线，用来连接分布式系统的所有节点。

Spring Cloud Bus将分布式的节点用轻量的消息代理(RibbitMQ/Kafka)连接起来，可以通过消息代理广播配置文件的更改，或者服务之间的通信，也可以用于监控。解决了微服务数据变更，及时同步的问题。

总的来说，就是在我们需要把一个操作散发到所有后端相关服务的时候，就可以选择使用Spring cloud Bus了。比如，消息总线的典型应用就是配置中心客户端刷新。

## 基本使用